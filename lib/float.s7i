
(********************************************************************)
(*                                                                  *)
(*  float.s7i     Floating point support library                    *)
(*  Copyright (C) 1993, 1994, 2005  Thomas Mertes                   *)
(*                                                                  *)
(*  This file is part of the Seed7 Runtime Library.                 *)
(*                                                                  *)
(*  The Seed7 Runtime Library is free software; you can             *)
(*  redistribute it and/or modify it under the terms of the GNU     *)
(*  Lesser General Public License as published by the Free Software *)
(*  Foundation; either version 2.1 of the License, or (at your      *)
(*  option) any later version.                                      *)
(*                                                                  *)
(*  The Seed7 Runtime Library is distributed in the hope that it    *)
(*  will be useful, but WITHOUT ANY WARRANTY; without even the      *)
(*  implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR *)
(*  PURPOSE.  See the GNU Lesser General Public License for more    *)
(*  details.                                                        *)
(*                                                                  *)
(*  You should have received a copy of the GNU Lesser General       *)
(*  Public License along with this program; if not, write to the    *)
(*  Free Software Foundation, Inc., 51 Franklin Street,             *)
(*  Fifth Floor, Boston, MA  02110-1301, USA.                       *)
(*                                                                  *)
(********************************************************************)


include "enable_io.s7i";


const type: float is          subtype object;
$ system "float" is float;

const proc: destroy (ref float param) is                           noop;
const proc: (ref float param) ::= (ref float param) is             action "FLT_CREATE";
IN_PARAM_IS_VALUE(float);

const float: (attr float) . value is 0.0;


(**
 *  Plus sign for float numbers.
 *  @return its operand unchanged.
 *)
const func float: + (ref float param) is                           action "FLT_PLUS";


(**
 *  Minus sign, negate a float number.
 *  @return the negated value of the number.
 *)
const func float: - (ref float param) is                           action "FLT_MINUS";


const proc: (inout float param) := (ref float param) is            action "FLT_CPY";
const proc: (inout float param) +:= (ref float param) is           action "FLT_GROW";
const proc: (inout float param) -:= (ref float param) is           action "FLT_SHRINK";
const proc: (inout float param) *:= (ref float param) is           action "FLT_MULT_ASSIGN";
const proc: (inout float param) /:= (ref float param) is           action "FLT_DIV_ASSIGN";


(**
 *  Add two float numbers.
 *  @return the sum of the two numbers.
 *)
const func float: (ref float param) + (ref float param) is         action "FLT_ADD";


(**
 *  Compute the subtraction of two float numbers.
 *  @return the difference of the two numbers.
 *)
const func float: (ref float param) - (ref float param) is         action "FLT_SBTR";


(**
 *  Multiply two float numbers.
 *  @return the product of the two numbers.
 *)
const func float: (ref float param) * (ref float param) is         action "FLT_MULT";


(**
 *  Compute the division of two float numbers.
 *  @return the quotient of the division.
 *)
const func float: (ref float param) / (ref float param) is         action "FLT_DIV";


const func float: (ref float param) ** (ref integer param) is      action "FLT_IPOW";
const func float: (ref float param) ** (ref float param) is        action "FLT_POW";
const func string: (ref float param) digits (ref integer param) is action "FLT_DGTS";
const func boolean: (ref float param) = (ref float param) is       action "FLT_EQ";
const func boolean: (ref float param) < (ref float param) is       action "FLT_LT";
const func boolean: (ref float param) > (ref float param) is       action "FLT_GT";
const func boolean: (ref float param) <= (ref float param) is      action "FLT_LE";
const func boolean: (ref float param) >= (ref float param) is      action "FLT_GE";
const func boolean: (ref float param) <> (ref float param) is      action "FLT_NE";
const func integer: (attr integer) cast (in float param) is        action "FLT_CAST";
const func float: (attr float) cast (in integer param) is          action "FLT_ICAST";


(**
 *  Compare two float numbers.
 *  @return -1, 0 or 1 if the first argument is considered to be
 *          respectively less than, equal to, or greater than the
 *          second.
 *)
const func integer: compare (in float param, in float param) is    action "FLT_CMP";


(**
 *  Compute the hash value of a float number.
 *  @return the hash value.
 *)
const func integer: hashCode (in float param) is                   action "FLT_HASHCODE";


(**
 *  Return the conversion of a float to a string.
 *)
const func string: str (ref float param) is                        action "FLT_STR";


(**
 *  Convert a string to a float.
 *  @return the float result of the conversion.
 *  @exception RANGE_ERROR When the string contains not a float literal.
 *)
const func float: (attr float) parse (in string param) is          action "FLT_PARSE";


(**
 *  Convert an integer to a float.
 *  @return the float result of the conversion.
 *)
const func float: flt (ref integer param) is                       action "FLT_IFLT";


(**
 *  Convert an integer to a float.
 *  @return the float result of the conversion.
 *)
const func float: (attr float) conv (ref integer param) is         action "FLT_ICONV";


(**
 *  Returns the nearest integer to the argument. Halfway cases are
 *  rounded away from zero.
 *)
const func integer: round (ref float param) is                     action "FLT_ROUND";


(**
 *  Returns the nearest integer not larger in absolute value than the
 *  argument.
 *)
const func integer: trunc (ref float param) is                     action "FLT_TRUNC";


(**
 *  Returns TRUE if the specified number is a Not-a-Number (NaN)
 *  value, FALSE otherwise.
 *)
const func boolean: isnan (ref float param) is                     action "FLT_ISNAN";


(**
 *  Return the conversion of a string to a float.
 *)
const func string: literal (ref float param) is                    action "FLT_STR";


(**
 *  Compute pseudo-random number in the range [A, B].
 *  @return the computed pseudo-random number.
 *  @exception RANGE_ERROR The range is empty
 *)
const func float: rand (ref float param, ref float param) is       action "FLT_RAND";


const float: Infinity is 1.0 / 0.0;
const float: NaN is 0.0 / 0.0;

const func boolean: (in float: a) = NaN is
  return isnan(a);

const func boolean: NaN = (in float: a) is
  return isnan(a);

enable_io(float);
